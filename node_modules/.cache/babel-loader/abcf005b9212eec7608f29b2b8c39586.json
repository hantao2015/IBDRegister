{"ast":null,"code":"import _Form from \"antd/es/form\";\nimport _Icon from \"antd/es/icon\";\nimport _message from \"antd/es/message\";\nvar _jsxFileName = \"/Users/mac/Desktop/IBDRegister/src/components/busniess/UploadFile/UploadFile.js\";\nimport React, { Component } from \"react\";\nimport \"./UploadFile.less\";\nimport http from \"../../../utils/api\";\n\nconst uploadFile = (file, url) => {\n  return new Promise((resolve, reject) => {\n    let fd = new FormData();\n    fd.append(\"file\", file, file.name);\n    const xhr = new XMLHttpRequest();\n    xhr.open(\"POST\", url);\n\n    xhr.onload = () => {\n      const data = JSON.parse(xhr.response);\n\n      if (xhr.status === 200 && (data.error === 0 || data.error === \"0\")) {\n        const imgUrl = data.data;\n        resolve(imgUrl);\n      } else {\n        reject(data);\n      }\n    };\n\n    xhr.send(fd);\n  });\n};\n\nclass UploadFile extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {};\n\n    this.getApplyData = async () => {\n      let res;\n      this.setState({\n        loading: true\n      });\n\n      try {\n        res = await http().getTable({// resid: applyDataBaseId\n        });\n        let data = [];\n        res.data && res.data.data && res.data.data.map(item => {\n          let studyType = item.studyType && item.studyType.split(\",\");\n          item.studyType = studyType;\n          data.push(item);\n        });\n\n        if (res.data.error == 0) {\n          this.setState({\n            applyList: data\n          });\n        }\n      } catch (error) {\n        _message.error(error.message);\n      }\n\n      this.setState({\n        loading: false\n      });\n    };\n\n    this.handleSubmit = (e, type) => {\n      this.props.form.validateFieldsAndScroll((err, values) => {\n        if (!err) {\n          this.onSubmit(values, type);\n        }\n      });\n    };\n\n    this.onSubmitRecord = async record => {\n      let res;\n      record.isSubmit = \"Y\";\n\n      try {\n        res = await http().modifyRecords({\n          // resid: applyDataBaseId,\n          data: [record]\n        });\n\n        if (res.data.Error == 0) {\n          _message.success(\"提交成功\");\n\n          await this.getApplyData();\n        }\n      } catch (error) {\n        _message.error(error.message);\n      }\n    };\n\n    this.handleUploadFile = async fileInfo => {\n      const file = fileInfo.file;\n      const bucketname = \"realsun\";\n      const type = \"\";\n      const fileUrl = \"http://ivf.realsun.me:9001/api/AliyunOss/PutOneImageObject?bucketname=\".concat(encodeURIComponent(bucketname), \"&srctype=\").concat(encodeURIComponent(type));\n\n      try {\n        await uploadFile(file, fileUrl).then(imageUrl => {\n          this.setState({\n            imageUrl\n          });\n        });\n      } catch (err) {\n        return _message.error(err.message);\n      }\n    };\n\n    this.onSubmit = async (values, type) => {\n      let res;\n      let obj = {};\n      let study = values.study && values.study.toString();\n\n      if (type === 1) {\n        obj = {\n          doctor: values.doctor,\n          hospital: values.hospital,\n          post: values.post,\n          phoneNumber: values.phone,\n          email: values.email,\n          teamPeople: values.teamPeople,\n          teamPeople2: values.teamPeople2,\n          teamPeople3: values.teamPeople3,\n          studyType: values.study,\n          CDPatientNumber: values.CDNumber,\n          UCPatientNumber: values.UCNumber,\n          doctorPhoto: this.state.imageUrl,\n          studyType: study\n        };\n      } else {\n        obj = {\n          doctor: values.doctor,\n          hospital: values.hospital,\n          post: values.post,\n          phoneNumber: values.phone,\n          email: values.email,\n          teamPeople: values.teamPeople,\n          teamPeople2: values.teamPeople2,\n          teamPeople3: values.teamPeople3,\n          studyType: values.study,\n          CDPatientNumber: values.CDNumber,\n          UCPatientNumber: values.UCNumber,\n          doctorPhoto: this.state.imageUrl,\n          studyType: study,\n          isSubmit: \"Y\"\n        };\n      }\n\n      try {\n        res = await http().addRecords({\n          resid: applyDataBaseId,\n          data: [obj]\n        });\n\n        if (res.data.Error == 0) {\n          _message.success(\"申请成功！\");\n        }\n\n        this.setState({\n          page: \"listPage\"\n        });\n        this.getApplyData();\n      } catch (error) {\n        _message.error(error.message);\n      }\n    };\n\n    this.getBase64 = (img, callback) => {\n      const reader = new FileReader();\n      reader.addEventListener(\"load\", () => callback(reader.result));\n      reader.readAsDataURL(img);\n    };\n\n    this.handleChange = info => {\n      console.log(\"info\", info);\n\n      if (info.file.status === \"uploading\") {\n        return;\n      }\n\n      if (info.file.status === \"done\") {\n        // Get this url from response in real world.\n        this.getBase64(info.file.originFileObj, imageUrl => this.setState({\n          imageUrl\n        }));\n      }\n    };\n  }\n\n  componentDidMount() {\n    this.getApplyData();\n  } //获取申请记录\n\n\n  render() {\n    const getFieldDecorator = this.props.form.getFieldDecorator;\n    const _this$state = this.state,\n          imageUrl = _this$state.imageUrl,\n          applyList = _this$state.applyList,\n          loading = _this$state.loading,\n          page = _this$state.page,\n          record = _this$state.record;\n    const formItemLayout = {\n      labelCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 8\n        }\n      },\n      wrapperCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 16\n        }\n      }\n    };\n    const tailFormItemLayout = {\n      wrapperCol: {\n        xs: {\n          span: 24,\n          offset: 0\n        },\n        sm: {\n          span: 16,\n          offset: 8\n        }\n      }\n    };\n    const uploadButton = React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }, React.createElement(_Icon, {\n      type: this.state.loading ? \"loading\" : \"plus\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"ant-upload-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, \"Upload\"));\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231\n      },\n      __self: this\n    });\n  }\n\n}\n\nexport default _Form.create()(UploadFile);","map":{"version":3,"sources":["/Users/mac/Desktop/IBDRegister/src/components/busniess/UploadFile/UploadFile.js"],"names":["React","Component","http","uploadFile","file","url","Promise","resolve","reject","fd","FormData","append","name","xhr","XMLHttpRequest","open","onload","data","JSON","parse","response","status","error","imgUrl","send","UploadFile","state","getApplyData","res","setState","loading","getTable","map","item","studyType","split","push","applyList","message","handleSubmit","e","type","props","form","validateFieldsAndScroll","err","values","onSubmit","onSubmitRecord","record","isSubmit","modifyRecords","Error","success","handleUploadFile","fileInfo","bucketname","fileUrl","encodeURIComponent","then","imageUrl","obj","study","toString","doctor","hospital","post","phoneNumber","phone","email","teamPeople","teamPeople2","teamPeople3","CDPatientNumber","CDNumber","UCPatientNumber","UCNumber","doctorPhoto","addRecords","resid","applyDataBaseId","page","getBase64","img","callback","reader","FileReader","addEventListener","result","readAsDataURL","handleChange","info","console","log","originFileObj","componentDidMount","render","getFieldDecorator","formItemLayout","labelCol","xs","span","sm","wrapperCol","tailFormItemLayout","offset","uploadButton","create"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./UploadFile.less\";\nimport {\n  Collapse,\n  Icon,\n  Input,\n  Upload,\n  Button,\n  Form,\n  Checkbox,\n  List,\n  Skeleton,\n  Avatar,\n  message,\n  Popconfirm,\n  Spin,\n  Tag,\n  Modal,\n  Steps,\n  Popover\n} from \"antd\";\nimport http from \"../../../utils/api\";\n\n\nconst uploadFile = (file, url) => {\n  return new Promise((resolve, reject) => {\n    let fd = new FormData();\n    fd.append(\"file\", file, file.name);\n    const xhr = new XMLHttpRequest();\n    xhr.open(\"POST\", url);\n    xhr.onload = () => {\n      const data = JSON.parse(xhr.response);\n      if (xhr.status === 200 && (data.error === 0 || data.error === \"0\")) {\n        const imgUrl = data.data;\n        resolve(imgUrl);\n      } else {\n        reject(data);\n      }\n    };\n    xhr.send(fd);\n  });\n};\nclass UploadFile extends Component {\n  state = {\n  };\n  componentDidMount() {\n    this.getApplyData();\n  }\n\n  //获取申请记录\n  getApplyData = async () => {\n    let res;\n    this.setState({\n      loading: true\n    });\n    try {\n      res = await http().getTable({\n        // resid: applyDataBaseId\n      });\n      let data = [];\n      res.data &&\n        res.data.data &&\n        res.data.data.map(item => {\n          let studyType = item.studyType && item.studyType.split(\",\");\n          item.studyType = studyType;\n          data.push(item);\n        });\n      if (res.data.error == 0) {\n        this.setState({\n          applyList: data\n        });\n      }\n    } catch (error) {\n      message.error(error.message);\n    }\n    this.setState({\n      loading: false\n    });\n  };\n\n  handleSubmit = (e, type) => {\n    this.props.form.validateFieldsAndScroll((err, values) => {\n      if (!err) {\n        this.onSubmit(values, type);\n      }\n    });\n  };\n  //提交列表中的一条记录\n  onSubmitRecord = async record => {\n    let res;\n    record.isSubmit = \"Y\";\n    try {\n      res = await http().modifyRecords({\n        // resid: applyDataBaseId,\n        data: [record]\n      });\n      if (res.data.Error == 0) {\n        message.success(\"提交成功\");\n        await this.getApplyData();\n      }\n    } catch (error) {\n      message.error(error.message);\n    }\n  };\n\n  //上传文件\n  handleUploadFile = async fileInfo => {\n    const file = fileInfo.file;\n    const bucketname = \"realsun\";\n    const type = \"\";\n    const fileUrl = `http://ivf.realsun.me:9001/api/AliyunOss/PutOneImageObject?bucketname=${encodeURIComponent(\n      bucketname\n    )}&srctype=${encodeURIComponent(type)}`;\n    try {\n      await uploadFile(file, fileUrl).then(imageUrl => {\n        this.setState({\n          imageUrl\n        });\n      });\n    } catch (err) {\n      return message.error(err.message);\n    }\n  };\n  //提交表单\n  onSubmit = async (values, type) => {\n    let res;\n    let obj = {};\n    let study = values.study && values.study.toString();\n    if (type === 1) {\n      obj = {\n        doctor: values.doctor,\n        hospital: values.hospital,\n        post: values.post,\n        phoneNumber: values.phone,\n        email: values.email,\n        teamPeople: values.teamPeople,\n        teamPeople2: values.teamPeople2,\n        teamPeople3: values.teamPeople3,\n        studyType: values.study,\n        CDPatientNumber: values.CDNumber,\n        UCPatientNumber: values.UCNumber,\n        doctorPhoto: this.state.imageUrl,\n        studyType: study\n      };\n    } else {\n      obj = {\n        doctor: values.doctor,\n        hospital: values.hospital,\n        post: values.post,\n        phoneNumber: values.phone,\n        email: values.email,\n        teamPeople: values.teamPeople,\n        teamPeople2: values.teamPeople2,\n        teamPeople3: values.teamPeople3,\n        studyType: values.study,\n        CDPatientNumber: values.CDNumber,\n        UCPatientNumber: values.UCNumber,\n        doctorPhoto: this.state.imageUrl,\n        studyType: study,\n        isSubmit: \"Y\"\n      };\n    }\n    try {\n      res = await http().addRecords({\n        resid: applyDataBaseId,\n        data: [obj]\n      });\n      if (res.data.Error == 0) {\n        message.success(\"申请成功！\");\n      }\n      this.setState({\n        page: \"listPage\"\n      });\n      this.getApplyData();\n    } catch (error) {\n      message.error(error.message);\n    }\n  };\n  getBase64 = (img, callback) => {\n    const reader = new FileReader();\n    reader.addEventListener(\"load\", () => callback(reader.result));\n    reader.readAsDataURL(img);\n  };\n  handleChange = info => {\n    console.log(\"info\", info);\n    if (info.file.status === \"uploading\") {\n      return;\n    }\n    if (info.file.status === \"done\") {\n      // Get this url from response in real world.\n      this.getBase64(info.file.originFileObj, imageUrl =>\n        this.setState({\n          imageUrl\n        })\n      );\n    }\n  };\n  render() {\n    const { getFieldDecorator } = this.props.form;\n    const { imageUrl, applyList, loading, page, record } = this.state;\n    const formItemLayout = {\n      labelCol: {\n        xs: { span: 24 },\n        sm: { span: 8 }\n      },\n      wrapperCol: {\n        xs: { span: 24 },\n        sm: { span: 16 }\n      }\n    };\n    const tailFormItemLayout = {\n      wrapperCol: {\n        xs: {\n          span: 24,\n          offset: 0\n        },\n        sm: {\n          span: 16,\n          offset: 8\n        }\n      }\n    };\n    const uploadButton = (\n      <div>\n        <Icon type={this.state.loading ? \"loading\" : \"plus\"} />\n        <div className=\"ant-upload-text\">Upload</div>\n      </div>\n    );\n\n    return (\n      <div></div>\n    );\n  }\n}\n\nexport default Form.create()(UploadFile);\n"]},"metadata":{},"sourceType":"module"}