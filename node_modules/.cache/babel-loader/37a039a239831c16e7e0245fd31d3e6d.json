{"ast":null,"code":"import _Form from \"antd/es/form\";\nimport _Spin from \"antd/es/spin\";\nimport _Table from \"antd/es/table\";\nimport _Modal from \"antd/es/modal\";\nimport _message from \"antd/es/message\";\nimport _Input from \"antd/es/input\";\nvar _jsxFileName = \"/Users/mac/Desktop/IBDRegister/src/components/busniess/DownFile/DownFile.js\";\nimport React, { Component } from \"react\";\nimport \"./DownFile.less\";\nimport http from \"../../../utils/api\";\nconst fileId = \"621892190597\";\nconst TextArea = _Input.TextArea;\n\nconst columns = props => {\n  const onDown = props.onDown;\n  return [{\n    title: \"文件名\",\n    dataIndex: \"fileName\",\n    key: \"fileName\",\n    width: 250\n  }, {\n    title: \"文件地址\",\n    dataIndex: \"fileUrl\",\n    key: \"fileUrl\",\n    width: 400\n  }, {\n    title: \"上传者\",\n    dataIndex: \"uploadPerson\",\n    key: \"uploadPerson\",\n    width: 150\n  }, {\n    title: \"上传时间\",\n    dataIndex: \"uploadDate\",\n    key: \"uploadDate\",\n    width: 150\n  }, {\n    title: \"操作\",\n    key: \"action\",\n    width: 150,\n    render: (text, record) => React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      onClick: () => {\n        onDown(record);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52\n      },\n      __self: this\n    }, \"\\u4E0B\\u8F7D\"))\n  }];\n};\n\nclass DownFile extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      spin: false,\n      data: [],\n      record: {},\n      visible: false,\n      fileUrl: \"\"\n    };\n\n    this.getData = async () => {\n      let res;\n      this.setState({\n        loading: true\n      });\n\n      try {\n        res = await http().getTable({\n          resid: fileId\n        });\n\n        if (res.data.error == 0) {\n          this.setState({\n            data: res.data.data\n          });\n        }\n      } catch (error) {\n        _message.error(error.message);\n      }\n\n      this.setState({\n        loading: false\n      });\n    };\n\n    this.handleSubmit = e => {\n      this.props.form.validateFieldsAndScroll((err, values) => {\n        if (!err) {\n          this.onSubmit(values);\n        }\n      });\n    };\n\n    this.onDown = url => {\n      if (!url) {\n        return _Modal.warning({\n          title: \"您还未上传过资料\"\n        });\n      }\n\n      const urls = url.split(\";file;\");\n\n      for (let i = 0, len = urls.length; i < len; i++) {\n        window.open(urls[i]);\n      }\n    };\n\n    this.handleUploadFile = async fileInfo => {\n      const file = fileInfo.file;\n      const bucketname = \"realsun\";\n      const type = \"\";\n      const fileUrl = \"http://ivf.realsun.me:9001/api/AliyunOss/PutOneImageObject?bucketname=\".concat(encodeURIComponent(bucketname), \"&srctype=\").concat(encodeURIComponent(type));\n\n      try {\n        await uploadFile(file, fileUrl).then(fileUrl => {\n          this.setState({\n            fileUrl\n          });\n        });\n      } catch (err) {\n        return _message.error(err.message);\n      }\n    };\n  }\n\n  componentDidMount() {\n    this.getData();\n  } //获取文件表记录\n\n\n  render() {\n    const _this$state = this.state,\n          spin = _this$state.spin,\n          data = _this$state.data;\n    return React.createElement(\"div\", {\n      className: \"editNotice\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, React.createElement(_Spin, {\n      spinning: spin,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, React.createElement(_Table, {\n      key: \"3\",\n      className: \"editNotice-table\",\n      columns: columns({\n        onDown: record => {\n          this.onDown(record.fileUrl);\n        },\n        data: data\n      }),\n      scroll: {\n        x: 1000,\n        y: \"calc(100vh - 260px)\"\n      },\n      dataSource: data,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default _Form.create()(DownFile);","map":{"version":3,"sources":["/Users/mac/Desktop/IBDRegister/src/components/busniess/DownFile/DownFile.js"],"names":["React","Component","http","fileId","TextArea","columns","props","onDown","title","dataIndex","key","width","render","text","record","DownFile","state","spin","data","visible","fileUrl","getData","res","setState","loading","getTable","resid","error","message","handleSubmit","e","form","validateFieldsAndScroll","err","values","onSubmit","url","warning","urls","split","i","len","length","window","open","handleUploadFile","fileInfo","file","bucketname","type","encodeURIComponent","uploadFile","then","componentDidMount","x","y","create"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./DownFile.less\";\nimport {\n  Collapse,\n  Icon,\n  Input,\n  Upload,\n  Button,\n  Form,\n  message,\n  Spin,\n  Modal,\n  Table\n} from \"antd\";\nimport http from \"../../../utils/api\";\n\nconst fileId = \"621892190597\";\nconst { TextArea } = Input;\nconst columns = props => {\n  const { onDown } = props;\n  return [\n    {\n      title: \"文件名\",\n      dataIndex: \"fileName\",\n      key: \"fileName\",\n      width: 250\n    },\n    {\n      title: \"文件地址\",\n      dataIndex: \"fileUrl\",\n      key: \"fileUrl\",\n      width: 400\n    },\n    {\n      title: \"上传者\",\n      dataIndex: \"uploadPerson\",\n      key: \"uploadPerson\",\n      width: 150\n    },\n    {\n      title: \"上传时间\",\n      dataIndex: \"uploadDate\",\n      key: \"uploadDate\",\n      width: 150\n    },\n    {\n      title: \"操作\",\n      key: \"action\",\n      width: 150,\n      render: (text, record) => (\n        <span>\n          <a\n            onClick={() => {\n              onDown(record);\n            }}\n          >\n            下载\n          </a>\n        </span>\n      )\n    }\n  ];\n};\nclass DownFile extends Component {\n  state = {\n    spin: false,\n    data: [],\n    record: {},\n    visible: false,\n    fileUrl: \"\"\n  };\n  componentDidMount() {\n    this.getData();\n  }\n\n  //获取文件表记录\n  getData = async () => {\n    let res;\n    this.setState({\n      loading: true\n    });\n    try {\n      res = await http().getTable({\n        resid: fileId\n      });\n      if (res.data.error == 0) {\n        this.setState({\n          data: res.data.data\n        });\n      }\n    } catch (error) {\n      message.error(error.message);\n    }\n    this.setState({\n      loading: false\n    });\n  };\n\n  handleSubmit = e => {\n    this.props.form.validateFieldsAndScroll((err, values) => {\n      if (!err) {\n        this.onSubmit(values);\n      }\n    });\n  };\n  //下载文件\n  onDown = url => {\n    if (!url) {\n      return Modal.warning({\n        title: \"您还未上传过资料\"\n      });\n    }\n    const urls = url.split(\";file;\");\n    for (let i = 0, len = urls.length; i < len; i++) {\n      window.open(urls[i]);\n    }\n  };\n  //上传文件\n  handleUploadFile = async fileInfo => {\n    const file = fileInfo.file;\n    const bucketname = \"realsun\";\n    const type = \"\";\n    const fileUrl = `http://ivf.realsun.me:9001/api/AliyunOss/PutOneImageObject?bucketname=${encodeURIComponent(\n      bucketname\n    )}&srctype=${encodeURIComponent(type)}`;\n    try {\n      await uploadFile(file, fileUrl).then(fileUrl => {\n        this.setState({\n          fileUrl\n        });\n      });\n    } catch (err) {\n      return message.error(err.message);\n    }\n  };\n  render() {\n    const { spin, data } = this.state;\n    return (\n      <div className=\"editNotice\">\n        <Spin spinning={spin}>\n          <Table\n            key=\"3\"\n            className=\"editNotice-table\"\n            columns={columns({\n              onDown: record => {\n                this.onDown(record.fileUrl);\n              },\n              data: data\n            })}\n            scroll={{ x: 1000, y: \"calc(100vh - 260px)\" }}\n            dataSource={data}\n          />\n        </Spin>\n      </div>\n    );\n  }\n}\n\nexport default Form.create()(DownFile);\n"]},"metadata":{},"sourceType":"module"}