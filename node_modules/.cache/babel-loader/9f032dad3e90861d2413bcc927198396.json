{"ast":null,"code":"\"use strict\";\n\nvar _httpCore = _interopRequireDefault(require(\"../httpCore\"));\n\nvar _util = require(\"../util\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n/**\n * 修改保存记录前获取记录（通过计算公式计算得出）\n */\n\n/**\n * 处理请求体\n * @param {object} reqBody 添加记录时发送给后端的请求体（未处理）\n *\n * @param {number} reqBody.resid 表资源 id\n * @param {array} reqBody.data 记录数组\n *\n */\n\n\nvar dealRequestBody = function dealRequestBody(reqBody) {\n  var newReqBody = (0, _util.clone)(reqBody); // 防止改变传进来的 records ，从而影响外面\n\n  var state = 'modified';\n  newReqBody.data.forEach(function (record, index) {\n    record._id = index + 1;\n    record._state = state;\n  });\n  newReqBody.data = JSON.stringify(newReqBody.data);\n  newReqBody.rp = {\n    EnableFormulaVerify: 'false',\n    EnableBitianCheck: false\n  };\n  return newReqBody;\n};\n\n_httpCore.default.createApi('beforeSaveModify', {\n  method: 'post',\n  url: '/api/100/table/RunInnerTableFormulaBeforeSave'\n}, dealRequestBody);","map":null,"metadata":{},"sourceType":"script"}